<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Revision Bhai</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif; background: #0a0e1a; color: #e8edf5; min-height: 100vh; display: flex; flex-direction: column; }
        
        /* Main content wrapper */
        .main-content { flex: 1; background: radial-gradient(ellipse at 20% 50%, rgba(14, 165, 233, 0.06) 0%, transparent 50%), radial-gradient(ellipse at 80% 20%, rgba(168, 85, 247, 0.05) 0%, transparent 50%); }
        
        /* Hero Section */
        .hero { text-align: center; padding: 120px 20px; max-width: 1200px; margin: 0 auto; }
        .hero.hidden { display: none; }
        .hero h1 { font-size: 48px; margin-bottom: 20px; background: linear-gradient(135deg, #38bdf8 0%, #a78bfa 50%, #f472b6 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .hero p { font-size: 20px; color: #8b95a8; margin-bottom: 40px; line-height: 1.6; }
        .cta-buttons { display: grid; grid-template-columns: repeat(4, 1fr); gap: 30px; max-width: 1400px; margin: 0 auto; }
        .btn { padding: 40px 50px; border-radius: 18px; text-decoration: none; font-weight: 700; font-size: 24px; transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1); cursor: pointer; background: linear-gradient(135deg, #0ea5e9 0%, #8b5cf6 100%); color: #fff; border: none; box-shadow: 0 8px 25px rgba(14, 165, 233, 0.25), inset 0 1px 0 rgba(255,255,255,0.1); letter-spacing: 0.5px; }
        .btn:hover { transform: translateY(-5px); box-shadow: 0 16px 40px rgba(14, 165, 233, 0.4); }
        .btn.active { background: linear-gradient(135deg, #f59e0b 0%, #ef4444 100%); box-shadow: 0 0 0 4px rgba(245, 158, 11, 0.4), 0 8px 25px rgba(245, 158, 11, 0.3); }
        
        /* Roadmaps Grid */
        .roadmaps { max-width: 1200px; margin: 60px auto; padding: 0 40px; display: none; }
        .roadmaps.active { display: block; background: rgba(14, 165, 233, 0.04); border: 1px solid rgba(14, 165, 233, 0.15); border-radius: 24px; padding: 30px 40px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3); backdrop-filter: blur(10px); }
        .section-title { font-size: 24px; margin-bottom: 10px; text-align: center; display: none; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 24px; margin-bottom: 60px; }
        .card { background: rgba(15, 23, 42, 0.7); border: 1px solid rgba(56, 189, 248, 0.12); border-radius: 16px; padding: 24px; transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1); cursor: pointer; backdrop-filter: blur(8px); }
        .card:hover { transform: translateY(-6px); border-color: rgba(56, 189, 248, 0.4); box-shadow: 0 12px 35px rgba(14, 165, 233, 0.15), 0 0 0 1px rgba(56, 189, 248, 0.1); }
        .card-icon { font-size: 32px; margin-bottom: 16px; }
        .card-title { font-size: 20px; font-weight: 600; margin-bottom: 8px; color: #f1f5f9; }
        .card-desc { font-size: 14px; color: #8b95a8; line-height: 1.5; }
        
        /* Roadmap View */
        .roadmap-view { width: 100%; min-height: 100vh; padding: 10px 20px; display: none; background: #0a0e1a; overflow: hidden; position: relative; }
        .roadmap-view.active { display: block; }
        .back-btn { background: linear-gradient(135deg, #f59e0b 0%, #ef4444 100%); color: #fff; border: none; padding: 12px 24px; border-radius: 12px; cursor: pointer; margin-bottom: 10px; font-size: 16px; font-weight: 700; box-shadow: 0 4px 18px rgba(245, 158, 11, 0.35); transition: all 0.3s; }
        .back-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 28px rgba(245, 158, 11, 0.5); }
        
        .roadmap-container { width: 100%; height: calc(100vh - 100px); overflow: auto; position: relative; }
        .roadmap-canvas { position: relative; width: 1400px; min-height: 1200px; margin: 0 auto; transform-origin: 0 0; transition: transform 0.3s ease; }
        
        .roadmap-box { position: absolute; background: rgba(15, 23, 42, 0.85); border: 2px solid #38bdf8; border-radius: 12px; padding: 15px 20px; font-size: 14px; font-weight: 600; color: #e8edf5; cursor: pointer; transition: all 0.3s; text-align: center; min-width: 150px; backdrop-filter: blur(8px); }
        .roadmap-box:hover { transform: scale(1.07); box-shadow: 0 6px 24px rgba(56, 189, 248, 0.35); background: rgba(30, 41, 59, 0.9); }
        .roadmap-box.start { background: linear-gradient(135deg, #0ea5e9 0%, #8b5cf6 100%); border-color: #8b5cf6; }
        .roadmap-box.important { border-color: #f59e0b; background: rgba(30, 20, 10, 0.8); }
        .roadmap-box.status-done { background: rgba(16, 50, 30, 0.85) !important; border-color: #34d399 !important; }
        .roadmap-box.status-in-progress { background: rgba(50, 40, 10, 0.85) !important; border-color: #fbbf24 !important; }

        
        svg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0; }
        .roadmap-canvas > svg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0; }
        .roadmap-box { z-index: 1; }
        
        /* Popup Overlay */
        .popup-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.75); display: none; z-index: 99; opacity: 0; transition: opacity 0.3s ease; backdrop-filter: blur(4px); }
        .popup-overlay.active { display: block; opacity: 1; }
        
        /* Popup Box */
        .popup-box { position: fixed; top: 50vh; left: 50vw; transform: translate(-50%, -50%) scale(0.8); display: none; background: linear-gradient(145deg, #111827 0%, #0f172a 100%); border: 1px solid rgba(56, 189, 248, 0.25); border-radius: 16px; padding: 24px; width: 600px; max-width: 90vw; max-height: 85vh; overflow-y: auto; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.7), 0 0 40px rgba(14, 165, 233, 0.08); z-index: 100; opacity: 0; transition: all 0.3s ease; }
        .popup-box.active { display: block; opacity: 1; transform: translate(-50%, -50%) scale(1); }
        .popup-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; gap: 10px; }
        .popup-title { font-size: 20px; color: #38bdf8; font-weight: bold; flex: 1; }
        .popup-actions { display: flex; gap: 8px; align-items: center; }
        .popup-body ul { margin-left: 0; list-style: none; padding: 0; }
        .popup-body li { margin: 10px 0; color: #b0bac9; line-height: 1.5; font-size: 13px; display: flex; align-items: flex-start; gap: 10px; word-wrap: break-word; }
        .popup-body li input[type="checkbox"] { margin-top: 3px; cursor: pointer; width: 16px; height: 16px; flex-shrink: 0; accent-color: #34d399; }
        .popup-body li span { flex: 1; }
        .popup-body li.checked span { color: #34d399; }
        
        /* Progress Counter */
        .progress-counter { position: fixed; top: 20px; right: 40px; display: none; background: rgba(15, 23, 42, 0.9); border: 1px solid rgba(56, 189, 248, 0.2); border-radius: 14px; padding: 15px 20px; z-index: 50; transition: all 0.3s ease; backdrop-filter: blur(12px); }
        .progress-counter.active { display: block; }
        .progress-counter.pulse { animation: pulse 0.5s ease; }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); box-shadow: 0 0 25px rgba(56, 189, 248, 0.4); } }
        .counter-item { display: flex; align-items: center; gap: 10px; margin: 8px 0; font-size: 14px; font-weight: 600; }
        .counter-item .dot { width: 10px; height: 10px; border-radius: 50%; }
        .counter-item.done-counter .dot { background: #34d399; }
        .counter-item.done-counter { color: #34d399; }
        .counter-item.in-progress-counter .dot { background: #fbbf24; }
        .counter-item.in-progress-counter { color: #fbbf24; }

        .counter-item.inactive { color: #4a5568; }
        .counter-item.inactive .dot { background: #4a5568; }
        .reset-btn { margin-top: 10px; padding: 6px 12px; background: rgba(220, 38, 38, 0.8); color: #fff; border: 1px solid #ef4444; border-radius: 8px; font-size: 11px; font-weight: 600; cursor: pointer; transition: all 0.3s; float: right; }
        .reset-btn:hover { background: #dc2626; transform: translateY(-1px); }
        
        /* Zoom Controls */
        .zoom-controls { position: fixed; bottom: 40px; left: 40px; display: none; flex-direction: column; gap: 10px; z-index: 50; }
        .zoom-controls.active { display: flex; }
        .zoom-btn { background: rgba(15, 23, 42, 0.9); color: #e8edf5; border: 1px solid rgba(56, 189, 248, 0.25); padding: 12px 16px; border-radius: 10px; cursor: pointer; font-size: 18px; font-weight: 600; transition: all 0.3s; backdrop-filter: blur(8px); }
        .zoom-btn:hover { background: rgba(30, 41, 59, 0.9); border-color: #38bdf8; transform: scale(1.08); }
        
        /* Progress Buttons */
        .progress-btn { padding: 6px 10px; border: none; border-radius: 8px; font-size: 11px; font-weight: 600; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; gap: 4px; }
        .progress-btn::before { content: ''; width: 8px; height: 8px; border-radius: 50%; }
        .progress-btn.done { background: rgba(16, 50, 30, 0.8); color: #34d399; border: 1px solid #34d399; }
        .progress-btn.done::before { background: #34d399; }
        .progress-btn.in-progress { background: rgba(50, 40, 10, 0.8); color: #fbbf24; border: 1px solid #fbbf24; }
        .progress-btn.in-progress::before { background: #fbbf24; }
        .progress-btn:hover { transform: translateY(-1px); }
        .progress-btn.btn-disabled { opacity: 0.5; }
        
        /* Feedback Widget */
        .feedback-widget { position: fixed; bottom: 60px; right: 40px; z-index: 50; }
        .feedback-btn { background: linear-gradient(135deg, #0ea5e9 0%, #8b5cf6 100%); color: #fff; border: none; padding: 14px 20px; border-radius: 50px; font-size: 14px; font-weight: 600; cursor: pointer; box-shadow: 0 4px 20px rgba(14, 165, 233, 0.35); transition: all 0.3s; display: flex; align-items: center; gap: 8px; }
        .feedback-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 32px rgba(14, 165, 233, 0.5); }
        .feedback-form { position: absolute; bottom: 60px; right: 0; background: linear-gradient(145deg, #111827 0%, #0f172a 100%); border: 1px solid rgba(56, 189, 248, 0.2); border-radius: 16px; padding: 20px; width: 350px; box-shadow: 0 16px 48px rgba(0, 0, 0, 0.7); display: none; backdrop-filter: blur(12px); }
        .feedback-form.active { display: block; }
        .feedback-form h3 { color: #38bdf8; margin-bottom: 15px; font-size: 18px; }
        .feedback-categories { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px; }
        .category-btn { background: rgba(30, 41, 59, 0.7); color: #c4cdd9; border: 1px solid rgba(56, 189, 248, 0.1); padding: 10px; border-radius: 10px; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.3s; text-align: center; }
        .category-btn:hover { background: rgba(30, 41, 59, 0.9); border-color: rgba(56, 189, 248, 0.3); }
        .category-btn.selected { background: linear-gradient(135deg, #0ea5e9 0%, #8b5cf6 100%); border-color: transparent; color: #fff; }
        .feedback-form textarea { width: 100%; min-height: 120px; background: rgba(10, 14, 26, 0.8); border: 1px solid rgba(56, 189, 248, 0.12); border-radius: 10px; padding: 12px; color: #e8edf5; font-size: 14px; font-family: inherit; resize: vertical; display: none; }
        .feedback-form textarea.active { display: block; }
        .feedback-form textarea:focus { outline: none; border-color: #38bdf8; box-shadow: 0 0 0 3px rgba(56, 189, 248, 0.1); }
        .feedback-actions { display: none; gap: 10px; margin-top: 15px; }
        .feedback-actions.active { display: flex; }
        .feedback-submit { flex: 1; background: linear-gradient(135deg, #0ea5e9 0%, #8b5cf6 100%); color: #fff; border: none; padding: 10px; border-radius: 10px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s; }
        .feedback-submit:hover { transform: translateY(-2px); box-shadow: 0 4px 18px rgba(14, 165, 233, 0.4); }
        .feedback-cancel { flex: 1; background: rgba(30, 41, 59, 0.7); color: #c4cdd9; border: 1px solid rgba(56, 189, 248, 0.1); padding: 10px; border-radius: 10px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s; }
        .feedback-cancel:hover { background: rgba(30, 41, 59, 0.9); }
        
        /* Header */
        header { background: linear-gradient(135deg, #0c4a6e 0%, #581c87 50%, #831843 100%); padding: 20px 60px; border-bottom: none; box-shadow: 0 4px 30px rgba(14, 165, 233, 0.15), 0 1px 0 rgba(255,255,255,0.05) inset; display: flex; align-items: center; justify-content: space-between; }
        .header-left { display: flex; align-items: center; gap: 20px; }
        .logo { width: 50px; height: 50px; background: linear-gradient(135deg, #38bdf8, #a78bfa); border-radius: 14px; display: flex; align-items: center; justify-content: center; font-size: 28px; font-weight: 800; color: #fff; box-shadow: 0 4px 18px rgba(14, 165, 233, 0.3); }
        .header-content { }
        header h1 { font-size: 32px; font-weight: 700; color: #fff; margin: 0; letter-spacing: -0.5px; }
        header p { color: rgba(224, 231, 255, 0.7); font-size: 14px; font-weight: 400; margin: 5px 0 0 0; }
        .header-right { display: flex; align-items: center; gap: 15px; }
        .youtube-link { display: flex; align-items: center; gap: 8px; padding: 10px 20px; background: #dc2626; color: #fff; text-decoration: none; border-radius: 10px; font-size: 14px; font-weight: 600; transition: all 0.3s; }
        .youtube-link:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(220, 38, 38, 0.4); background: #ef4444; }
        .login-btn { padding: 10px 24px; background: rgba(255, 255, 255, 0.1); color: #fff; border: 1px solid rgba(255, 255, 255, 0.3); border-radius: 10px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(4px); }
        .login-btn:hover { background: rgba(255, 255, 255, 0.95); color: #0c4a6e; transform: translateY(-2px); }
        .login-btn svg { flex-shrink: 0; }
        
        /* Footer */
        footer { background: rgba(15, 23, 42, 0.8); padding: 40px; text-align: center; border-top: 1px solid rgba(56, 189, 248, 0.08); margin-top: auto; }
        footer p { color: #6b7a8d; font-size: 14px; }
        
        /* User Profile */
        .user-profile { display: flex; align-items: center; gap: 10px; }
        .user-avatar { width: 36px; height: 36px; border-radius: 50%; border: 2px solid rgba(255,255,255,0.5); }
        .user-name { font-size: 14px; font-weight: 600; color: #fff; }
        .logout-btn { padding: 8px 16px; background: rgba(255, 255, 255, 0.1); color: #fff; border: 1px solid rgba(255,255,255,0.3); border-radius: 8px; font-size: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s; }
        .logout-btn:hover { background: rgba(255,255,255,0.95); color: #0c4a6e; }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            header { padding: 15px 20px; flex-direction: column; gap: 15px; }
            .header-left { flex-direction: column; gap: 10px; text-align: center; }
            .logo { width: 40px; height: 40px; font-size: 22px; }
            header h1 { font-size: 24px; }
            header p { font-size: 12px; }
            .header-right { flex-direction: column; gap: 10px; width: 100%; }
            .youtube-link { width: 100%; justify-content: center; }
            .login-btn { width: 100%; justify-content: center; }
            .user-profile { width: 100%; justify-content: center; flex-wrap: wrap; }
            .hero { padding: 60px 15px; }
            .hero h1 { font-size: 32px; }
            .hero p { font-size: 16px; }
            .cta-buttons { grid-template-columns: 1fr 1fr; gap: 15px; }
            .btn { padding: 25px 20px; font-size: 18px; }
            .roadmaps { padding: 0 20px; }
            .roadmaps.active { padding: 20px; }
            .grid { grid-template-columns: 1fr; gap: 16px; }
            .roadmap-view { padding: 10px; }
            .back-btn { font-size: 14px; padding: 10px 18px; }
            .roadmap-container { height: calc(100vh - 80px); }
            .roadmap-canvas { width: 1400px; min-height: 1200px; }
            .progress-counter { top: 10px; right: 10px; padding: 10px 15px; font-size: 12px; }
            .counter-item { font-size: 12px; margin: 5px 0; }
            .reset-btn { font-size: 10px; padding: 5px 10px; }
            .zoom-controls { bottom: 20px; left: 10px; gap: 8px; }
            .zoom-btn { padding: 10px 12px; font-size: 16px; }
            .feedback-widget { bottom: 20px; right: 10px; }
            .feedback-btn { padding: 12px 16px; font-size: 13px; }
            .feedback-form { width: 90vw; max-width: 320px; right: -10px; }
            .popup-box { width: 95vw; padding: 15px; }
            .popup-title { font-size: 18px; }
            .popup-body li { font-size: 12px; }
            .progress-btn { font-size: 10px; padding: 5px 8px; }
            .custom-alert { min-width: 90vw !important; padding: 20px 25px !important; }
        }
        
        @media (max-width: 480px) {
            .cta-buttons { grid-template-columns: 1fr; }
            .btn { padding: 20px 15px; font-size: 16px; }
            header h1 { font-size: 20px; }
            .hero h1 { font-size: 28px; }
            .feedback-categories { grid-template-columns: 1fr; }
        }
    </style>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
</head>
<body>
    <header>
        <div class="header-left">
            <div class="logo">RB</div>
            <div class="header-content">
                <h1>Revision Bhai</h1>
                <p>Your comprehensive learning companion for exam preparation</p>
            </div>
        </div>
        <div class="header-right">
            <a href="https://youtube.com/@revisionbhai" target="_blank" class="youtube-link">
                <span>‚ñ∂</span>
                <span>YouTube</span>
            </a>
            <div id="user-section">
                <button class="login-btn" id="login-btn" onclick="handleLogin()">
                    <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Gmail" style="width: 18px; height: 18px; margin-right: 8px;">
                    <span>Login with Gmail</span>
                </button>
                <div class="user-profile" id="user-profile" style="display: none;">
                    <img class="user-avatar" id="user-avatar" src="" alt="User">
                    <span class="user-name" id="user-name"></span>
                    <button class="logout-btn" onclick="handleLogout()">Logout</button>
                </div>
            </div>
        </div>
    </header>
    <div class="main-content">
        <section class="hero" id="hero-section">
            <div class="cta-buttons">
                <button class="btn" onclick="toggleTab('History', this)">History</button>
                <button class="btn" onclick="toggleTab('Geography', this)">Geography</button>
                <button class="btn" onclick="toggleTab('Economy', this)">Economy</button>
                <button class="btn" onclick="toggleTab('Polity', this)">Polity</button>
            </div>
        </section>

        <section class="roadmaps" id="History">
            <h2 class="section-title">History Chapters</h2>
            <div class="grid">
                <div class="card" onclick="showRoadmap('chap1')">
                    <div class="card-icon">üé®</div>
                    <div class="card-title">Chap-1</div>
                    <div class="card-desc">Step by step guide to becoming a modern frontend developer</div>
                </div>
                <div class="card">
                    <div class="card-icon">‚öôÔ∏è</div>
                    <div class="card-title">Chap-2</div>
                    <div class="card-desc">Step by step guide to becoming a modern backend developer</div>
                </div>
                <div class="card">
                    <div class="card-icon">üîß</div>
                    <div class="card-title">Chap-3</div>
                    <div class="card-desc">Step by step guide to becoming a modern DevOps engineer</div>
                </div>
                <div class="card">
                    <div class="card-icon">üì±</div>
                    <div class="card-title">Chap-4</div>
                    <div class="card-desc">Step by step guide to becoming a modern full stack developer</div>
                </div>
                <div class="card">
                    <div class="card-icon">ü§ñ</div>
                    <div class="card-title">Chap-5</div>
                    <div class="card-desc">Step by step guide to becoming an AI engineer</div>
                </div>
                <div class="card">
                    <div class="card-icon">üîí</div>
                    <div class="card-title">Chap-6</div>
                    <div class="card-desc">Step by step guide to becoming a security expert</div>
                </div>
            </div>
        </section>

        <section class="roadmaps" id="Geography">
            <h2 class="section-title">Geography Content</h2>
            <p style="text-align: center; color: #8b95a8;">Geography content will go here</p>
        </section>

        <section class="roadmaps" id="Economy">
            <h2 class="section-title">Economy Content</h2>
            <p style="text-align: center; color: #8b95a8;">Economy content will go here</p>
        </section>

        <section class="roadmaps" id="Polity">
            <h2 class="section-title">Polity Content</h2>
            <p style="text-align: center; color: #8b95a8;">Polity content will go here</p>
        </section>

        <!-- Chap-1 Roadmap View -->
        <section class="roadmap-view" id="chap1-roadmap">
            <button class="back-btn" onclick="backToChapters()">‚Üê Back to Chapters</button>
            <h2 class="section-title">Chap-1: History Roadmap</h2>
            
            <!-- Progress Counter -->
            <div class="progress-counter" id="progress-counter">
                <div class="counter-item done-counter inactive">
                    <span class="dot"></span>
                    <span>Done: <span id="done-count">0</span></span>
                </div>
                <div class="counter-item in-progress-counter inactive">
                    <span class="dot"></span>
                    <span>In Progress: <span id="progress-count">0</span></span>
                </div>
                <button class="reset-btn" onclick="resetProgress()">Reset</button>
            </div>
            
            <!-- Zoom Controls -->
            <div class="zoom-controls" id="zoom-controls">
                <button class="zoom-btn" onclick="zoomIn()" title="Zoom In">+</button>
                <button class="zoom-btn" onclick="zoomOut()" title="Zoom Out">‚àí</button>
                <button class="zoom-btn" onclick="resetZoom()" title="Reset Zoom">‚ü≤</button>
            </div>
            
            <div class="roadmap-container" id="roadmap-container">
            <div class="roadmap-canvas" id="roadmap-canvas">
                <svg>
                    <line x1="700" y1="80" x2="700" y2="150" stroke="#38bdf8" stroke-width="2"/>
                    <line x1="700" y1="200" x2="500" y2="270" stroke="#38bdf8" stroke-width="2"/>
                    <line x1="700" y1="200" x2="900" y2="270" stroke="#38bdf8" stroke-width="2"/>
                    <line x1="500" y1="320" x2="500" y2="390" stroke="#38bdf8" stroke-width="2"/>
                    <line x1="900" y1="320" x2="900" y2="390" stroke="#38bdf8" stroke-width="2"/>
                    <line x1="500" y1="440" x2="700" y2="510" stroke="#38bdf8" stroke-width="2"/>
                    <line x1="900" y1="440" x2="700" y2="510" stroke="#38bdf8" stroke-width="2"/>
                    <line x1="700" y1="560" x2="700" y2="630" stroke="#38bdf8" stroke-width="2"/>
                    <line x1="700" y1="680" x2="500" y2="750" stroke="#38bdf8" stroke-width="2"/>
                    <line x1="700" y1="680" x2="900" y2="750" stroke="#38bdf8" stroke-width="2"/>
                </svg>
                
                <!-- Introduction -->
                <div class="roadmap-box" style="top: 30px; left: 600px;">Introduction to History</div>
                
                <!-- Main Path -->
                <div class="roadmap-box" style="top: 150px; left: 575px;">Ancient Civilizations</div>
                
                <!-- Branch 1 -->
                <div class="roadmap-box" style="top: 270px; left: 400px;">Mesopotamia</div>
                <div class="roadmap-box" style="top: 270px; left: 800px;">Ancient Egypt</div>
                
                <!-- Sub branches -->
                <div class="roadmap-box" style="top: 390px; left: 400px;">Sumerian Culture</div>
                <div class="roadmap-box" style="top: 390px; left: 800px;">Pharaohs & Pyramids</div>
                
                <!-- Merge back -->
                <div class="roadmap-box" style="top: 510px; left: 575px;">Classical Period</div>
                
                <!-- Continue -->
                <div class="roadmap-box" style="top: 630px; left: 600px;">Greek & Roman Era</div>
                
                <!-- Final branches -->
                <div class="roadmap-box" style="top: 750px; left: 400px;">Greek Philosophy</div>
                <div class="roadmap-box" style="top: 750px; left: 800px;">Roman Empire</div>
                
                <!-- Additional topics -->
                <div class="roadmap-box" style="top: 150px; left: 200px;" onclick="showPopup(event, 'indus-valley')">Indus Valley</div>
                <div class="roadmap-box" style="top: 150px; left: 950px;" onclick="showPopup(event, 'ancient-china')">Ancient China</div>
                <div class="roadmap-box" style="top: 510px; left: 200px;">Persian Empire</div>
                <div class="roadmap-box" style="top: 510px; left: 950px;">Byzantine Era</div>
                
                <!-- Popup Overlay -->
                <div class="popup-overlay" id="popup-overlay" onclick="closePopup()"></div>
                
                <!-- Popup Box -->
                <div class="popup-box" id="popup-box">
                    <div class="popup-header">
                        <h3 class="popup-title" id="popup-title">Topic Title</h3>
                        <div class="popup-actions">
                            <button class="progress-btn done" onclick="checkAndSetProgress('done')" id="done-btn" type="button">Done</button>
                            <button class="progress-btn in-progress" onclick="setProgress('in-progress')">In Progress</button>
                        </div>
                    </div>
                    <div class="popup-body" id="popup-body">
                        <!-- Content will be inserted here -->
                    </div>
                </div>
            </div>
            </div>
        </section>
    </div>

    <footer>
        <p>¬© 2024 Developer Roadmaps. Community driven learning paths.</p>
    </footer>

    <!-- Feedback Widget -->
    <div class="feedback-widget">
        <button class="feedback-btn" onclick="toggleFeedback()">
            <span>üí¨</span>
            <span>Feedback</span>
        </button>
        <div class="feedback-form" id="feedback-form">
            <h3>Send Feedback</h3>
            <div class="feedback-categories">
                <button class="category-btn" onclick="selectCategory(this, 'Incorrect Notes')">üìù Incorrect Notes</button>
                <button class="category-btn" onclick="selectCategory(this, 'Appreciation')">‚ù§Ô∏è Appreciation</button>
                <button class="category-btn" onclick="selectCategory(this, 'Website Improvements')">üöÄ Improvements</button>
                <button class="category-btn" onclick="selectCategory(this, 'Bhadas')">üò§ Bhadas</button>
            </div>
            <textarea id="feedback-text" placeholder="Share your feedback..."></textarea>
            <div class="feedback-actions">
                <button class="feedback-submit" onclick="submitFeedback()">Send</button>
                <button class="feedback-cancel" onclick="toggleFeedback()">Cancel</button>
            </div>
        </div>
    </div>

    <script>
        // Firebase Configuration - REPLACE WITH YOUR CONFIG
        const firebaseConfig = {
            apiKey: "AIzaSyAPtnjmxKdSYxfNOSgUHpLCCx4aSQb2HNs",
            authDomain: "revision-bhai.firebaseapp.com",
            projectId: "revision-bhai",
            storageBucket: "revision-bhai.firebasestorage.app",
            messagingSenderId: "458753739993",
            appId: "1:458753739993:web:5f12045ffa748f050dc2c8",
            measurementId: "G-YWQSBBJDN8"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        let currentUser = null;

        // Auth State Observer
        auth.onAuthStateChanged(user => {
            if (user) {
                currentUser = user;
                document.getElementById('login-btn').style.display = 'none';
                document.getElementById('user-profile').style.display = 'flex';
                document.getElementById('user-avatar').src = user.photoURL || 'https://via.placeholder.com/36';
                document.getElementById('user-name').textContent = user.displayName || user.email;
                loadProgressFromFirebase();
            } else {
                currentUser = null;
                document.getElementById('login-btn').style.display = 'block';
                document.getElementById('user-profile').style.display = 'none';
            }
        });

        // Login with Google
        async function handleLogin() {
            const provider = new firebase.auth.GoogleAuthProvider();
            try {
                await auth.signInWithPopup(provider);
            } catch (error) {
                if (error.code !== 'auth/popup-closed-by-user' && error.code !== 'auth/cancelled-popup-request') {
                    showCustomAlert('Login failed: ' + error.message);
                }
            }
        }

        // Logout
        async function handleLogout() {
            try {
                await auth.signOut();
                progressCounts = { done: 0, 'in-progress': 0 };
                document.querySelectorAll('.roadmap-box').forEach(box => {
                    box.classList.remove('status-done', 'status-in-progress');
                    box.dataset.checkboxStates = '[]';
                });
                document.getElementById('done-count').textContent = '0';
                document.getElementById('progress-count').textContent = '0';
                document.querySelector('.done-counter').classList.add('inactive');
                document.querySelector('.in-progress-counter').classList.add('inactive');
            } catch (error) {
                showCustomAlert('Logout failed: ' + error.message);
            }
        }

        let currentZoom = 1;
        let currentPopupId = null;
        let progressCounts = { done: 0, 'in-progress': 0 };

        const topicData = {
            'ancient-china': {
                title: 'Ancient China',
                content: `
                    <ul>
                        <li><strong>Shang Dynasty (1600-1046 BCE):</strong> First historically verified Chinese dynasty, known for bronze work and oracle bone script</li>
                        <li><strong>Zhou Dynasty (1046-256 BCE):</strong> Longest-lasting dynasty, introduced the Mandate of Heaven concept</li>
                        <li><strong>Confucianism:</strong> Philosophy emphasizing moral values, family loyalty, and social harmony</li>
                        <li><strong>Great Wall Construction:</strong> Began during Warring States period, unified under Qin Dynasty</li>
                        <li><strong>Qin Dynasty (221-206 BCE):</strong> First unified Chinese empire, standardized writing, currency, and measurements</li>
                        <li><strong>Han Dynasty (206 BCE-220 CE):</strong> Golden age of Chinese civilization, established Silk Road trade routes</li>
                        <li><strong>Inventions:</strong> Paper, gunpowder, compass, and printing technology originated in ancient China</li>
                        <li><strong>Agricultural Society:</strong> Rice cultivation in south, millet and wheat in north formed economic foundation</li>
                    </ul>
                `
            },
            'indus-valley': {
                title: 'Indus Valley Civilization',
                content: `
                    <ul>
                        <li><strong>Time Period (3300-1300 BCE):</strong> One of the world's earliest urban civilizations, contemporary with ancient Egypt and Mesopotamia</li>
                        <li><strong>Major Cities:</strong> Harappa and Mohenjo-daro were well-planned cities with advanced drainage systems</li>
                        <li><strong>Urban Planning:</strong> Grid-pattern streets, standardized brick sizes, and sophisticated water management systems</li>
                        <li><strong>Trade Networks:</strong> Extensive trade with Mesopotamia, Afghanistan, and Central Asia</li>
                        <li><strong>Writing System:</strong> Indus script remains undeciphered, found on seals and pottery</li>
                        <li><strong>Economy:</strong> Agriculture-based with wheat, barley, and cotton cultivation; also engaged in craft production</li>
                        <li><strong>Technology:</strong> Advanced metallurgy, bead-making, and standardized weights and measures</li>
                        <li><strong>Decline:</strong> Mysterious decline around 1300 BCE, possibly due to climate change or river course changes</li>
                    </ul>
                `
            }
        };

        function toggleTab(tabName, button) {
            const tab = document.getElementById(tabName);
            const isActive = button.classList.contains('active');
            
            if (isActive) {
                tab.classList.remove('active');
                button.classList.remove('active');
            } else {
                document.querySelectorAll('.roadmaps').forEach(t => {
                    t.classList.remove('active');
                });
                
                document.querySelectorAll('.btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                tab.classList.add('active');
                button.classList.add('active');
            }
        }

        function showRoadmap(chapId) {
            document.getElementById('hero-section').classList.add('hidden');
            document.querySelector('header').style.visibility = 'hidden';
            document.querySelector('header').style.position = 'absolute';
            document.getElementById('zoom-controls').classList.add('active');
            document.getElementById('progress-counter').classList.add('active');
            
            document.querySelectorAll('.roadmaps').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(chapId + '-roadmap').classList.add('active');
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function backToChapters() {
            document.getElementById('hero-section').classList.remove('hidden');
            document.querySelector('header').style.visibility = 'visible';
            document.querySelector('header').style.position = 'static';
            document.getElementById('zoom-controls').classList.remove('active');
            document.getElementById('progress-counter').classList.remove('active');
            
            document.querySelectorAll('.roadmap-view').forEach(view => {
                view.classList.remove('active');
            });
            document.getElementById('History').classList.add('active');
            resetZoom();
        }

        function showPopup(event, topicId) {
            event.stopPropagation();
            const popup = document.getElementById('popup-box');
            const overlay = document.getElementById('popup-overlay');
            const data = topicData[topicId];
            
            if (data) {
                currentPopupId = topicId;
                popup.dataset.topicElement = event.target.id || event.target.textContent;
                document.getElementById('popup-title').textContent = data.title;
                
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = data.content;
                const listItems = tempDiv.querySelectorAll('li');
                listItems.forEach(li => {
                    const checkbox = document.createElement('input');
                    checkbox.type = 'checkbox';
                    const textSpan = document.createElement('span');
                    textSpan.innerHTML = li.innerHTML;
                    li.innerHTML = '';
                    li.appendChild(checkbox);
                    li.appendChild(textSpan);
                });
                
                document.getElementById('popup-body').innerHTML = tempDiv.innerHTML;
                
                // Restore checkbox states if saved
                const savedStates = event.target.dataset.checkboxStates;
                if (savedStates) {
                    const states = JSON.parse(savedStates);
                    document.querySelectorAll('#popup-body input[type="checkbox"]').forEach((cb, index) => {
                        if (states[index]) {
                            cb.checked = true;
                            cb.parentElement.classList.add('checked');
                        }
                    });
                }
                
                // Add event listeners after DOM insertion
                document.querySelectorAll('#popup-body input[type="checkbox"]').forEach(cb => {
                    cb.addEventListener('change', function() {
                        if (this.checked) {
                            this.parentElement.classList.add('checked');
                        } else {
                            this.parentElement.classList.remove('checked');
                        }
                    });
                });
                
                overlay.classList.add('active');
                setTimeout(() => {
                    popup.classList.add('active');
                }, 10);
            }
        }

        function closePopup() {
            const popup = document.getElementById('popup-box');
            const overlay = document.getElementById('popup-overlay');
            popup.classList.remove('active');
            overlay.classList.remove('active');
            currentPopupId = null;
        }

        function checkAndSetProgress(status) {
            if (!currentUser) {
                showCustomAlert('Please <strong>Login</strong> to save your progress!', true);
                return;
            }
            setProgress(status);
        }

        function showCustomAlert(message, showLogin = false) {
            const alertBox = document.createElement('div');
            alertBox.style.cssText = 'position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: linear-gradient(145deg, #111827 0%, #0f172a 100%); border: 1px solid rgba(56, 189, 248, 0.25); border-radius: 20px; padding: 30px 40px; z-index: 200; box-shadow: 0 25px 60px rgba(0, 0, 0, 0.8), 0 0 40px rgba(14, 165, 233, 0.08); min-width: 400px; text-align: center;';
            const buttons = showLogin ? `
                <button onclick="event.stopPropagation(); this.parentElement.remove(); handleLogin();" style="background: linear-gradient(135deg, #0ea5e9 0%, #8b5cf6 100%); color: #fff; border: none; padding: 12px 30px; border-radius: 10px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 18px rgba(14, 165, 233, 0.35); margin-right: 10px;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 28px rgba(14, 165, 233, 0.5)'" onmouseout="this.style.transform=''; this.style.boxShadow='0 4px 18px rgba(14, 165, 233, 0.35)'">Sign In</button>
                <button onclick="event.stopPropagation(); this.parentElement.remove();" style="background: rgba(30, 41, 59, 0.7); color: #c4cdd9; border: 1px solid rgba(56, 189, 248, 0.2); padding: 12px 30px; border-radius: 10px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s;" onmouseover="this.style.background='rgba(30, 41, 59, 0.9)'" onmouseout="this.style.background='rgba(30, 41, 59, 0.7)'">Cancel</button>
            ` : `
                <button onclick="event.stopPropagation(); this.parentElement.remove();" style="background: linear-gradient(135deg, #0ea5e9 0%, #8b5cf6 100%); color: #fff; border: none; padding: 12px 30px; border-radius: 10px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 18px rgba(14, 165, 233, 0.35);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 28px rgba(14, 165, 233, 0.5)'" onmouseout="this.style.transform=''; this.style.boxShadow='0 4px 18px rgba(14, 165, 233, 0.35)'">OK</button>
            `;
            alertBox.innerHTML = `
                <div style="font-size: 18px; color: #e8edf5; margin-bottom: 20px; line-height: 1.6;">${message}</div>
                ${buttons}
            `;
            document.body.appendChild(alertBox);
        }

        function zoomIn() {
            currentZoom = Math.min(currentZoom + 0.2, 2);
            document.getElementById('roadmap-canvas').style.transform = `scale(${currentZoom})`;
        }

        function zoomOut() {
            currentZoom = Math.max(currentZoom - 0.2, 0.5);
            document.getElementById('roadmap-canvas').style.transform = `scale(${currentZoom})`;
        }

        function resetZoom() {
            currentZoom = 1;
            const canvas = document.getElementById('roadmap-canvas');
            const container = document.getElementById('roadmap-container');
            canvas.style.transform = `scale(1)`;
            container.scrollTo({ left: 0, top: 0, behavior: 'smooth' });
        }

        function updateProgressCounter() {
            if (!currentUser) return;
            
            document.getElementById('done-count').textContent = progressCounts.done;
            document.getElementById('progress-count').textContent = progressCounts['in-progress'];
            
            document.querySelector('.done-counter').classList.toggle('inactive', progressCounts.done === 0);
            document.querySelector('.in-progress-counter').classList.toggle('inactive', progressCounts['in-progress'] === 0);
            
            const counter = document.getElementById('progress-counter');
            counter.classList.add('pulse');
            setTimeout(() => counter.classList.remove('pulse'), 500);
            
            saveProgress();
        }

        function setProgress(status) {
            if (!currentUser) {
                showCustomAlert('Please <strong>Login</strong> to save your progress!', true);
                return;
            }
            if (currentPopupId) {
                // Save checkbox states
                const checkboxStates = [];
                document.querySelectorAll('#popup-body input[type="checkbox"]').forEach((cb, index) => {
                    checkboxStates.push(cb.checked);
                });
                
                const boxes = document.querySelectorAll('.roadmap-box');
                boxes.forEach(box => {
                    if (box.onclick && box.onclick.toString().includes(currentPopupId)) {
                        let previousStatus = null;
                        if (box.classList.contains('status-done')) previousStatus = 'done';
                        else if (box.classList.contains('status-in-progress')) previousStatus = 'in-progress';
                        
                        if (previousStatus) {
                            progressCounts[previousStatus]--;
                        }
                        
                        box.classList.remove('status-done', 'status-in-progress');
                        box.classList.add(`status-${status}`);
                        box.dataset.checkboxStates = JSON.stringify(checkboxStates);
                        
                        progressCounts[status]++;
                        
                        updateProgressCounter();
                    }
                });
            }
            closePopup();
        }

        function resetProgress() {
            progressCounts = { done: 0, 'in-progress': 0 };
            
            const boxes = document.querySelectorAll('.roadmap-box');
            boxes.forEach(box => {
                box.classList.remove('status-done', 'status-in-progress');
            });
            
            updateProgressCounter();
        }

        function saveProgress() {
            if (!currentUser) return;
            
            const topicStatuses = {};
            document.querySelectorAll('.roadmap-box').forEach(box => {
                const text = box.textContent.trim();
                if (box.classList.contains('status-done')) {
                    topicStatuses[text] = { status: 'done', checkboxStates: box.dataset.checkboxStates || '[]' };
                } else if (box.classList.contains('status-in-progress')) {
                    topicStatuses[text] = { status: 'in-progress', checkboxStates: box.dataset.checkboxStates || '[]' };
                }
            });
            
            // Save to Firebase only
            db.collection('users').doc(currentUser.uid).set({
                email: currentUser.email,
                progress: topicStatuses,
                lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
            }, { merge: true }).catch(err => console.error('Firebase save error:', err));
        }

        async function loadProgressFromFirebase() {
            if (!currentUser) return;
            try {
                const doc = await db.collection('users').doc(currentUser.uid).get();
                if (doc.exists && doc.data().progress) {
                    const topicStatuses = doc.data().progress;
                    progressCounts = { done: 0, 'in-progress': 0 };
                    document.querySelectorAll('.roadmap-box').forEach(box => {
                        box.classList.remove('status-done', 'status-in-progress');
                        const text = box.textContent.trim();
                        const topicData = topicStatuses[text];
                        if (topicData) {
                            const status = typeof topicData === 'string' ? topicData : topicData.status;
                            const checkboxStates = typeof topicData === 'object' ? topicData.checkboxStates : '[]';
                            box.classList.add(`status-${status}`);
                            box.dataset.checkboxStates = checkboxStates;
                            progressCounts[status]++;
                        }
                    });
                    updateProgressCounter();
                }
            } catch (error) {
                console.error('Firebase load error:', error);
            }
        }

        // Removed localStorage functions - login required for progress tracking

        // Feedback functions
        let selectedCategory = '';
        
        function toggleFeedback() {
            const form = document.getElementById('feedback-form');
            form.classList.toggle('active');
            if (!form.classList.contains('active')) {
                selectedCategory = '';
                document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('selected'));
                document.getElementById('feedback-text').value = '';
                document.getElementById('feedback-text').classList.remove('active');
                document.querySelector('.feedback-actions').classList.remove('active');
            }
        }

        function selectCategory(btn, category) {
            document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            selectedCategory = category;
            document.getElementById('feedback-text').classList.add('active');
            document.querySelector('.feedback-actions').classList.add('active');
        }

        async function submitFeedback() {
            const feedback = document.getElementById('feedback-text').value.trim();
            if (!selectedCategory) {
                showCustomAlert('Please select a feedback category');
                return;
            }
            if (!feedback) {
                showCustomAlert('Please enter your feedback');
                return;
            }
            
            try {
                // Replace with your Google Apps Script Web App URL
                const scriptUrl = 'https://script.google.com/macros/s/AKfycbzb6X3IJ3Ka-V3WhQmNE0BWTB6XCCGOveqXiR8_urDLQNX4m20zfQ-540khW2mLBZZccw/exec';
                
                const response = await fetch(scriptUrl, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        category: selectedCategory,
                        feedback: feedback,
                        timestamp: new Date().toISOString(),
                        page: window.location.href
                    })
                });
                
                document.getElementById('feedback-text').value = '';
                document.getElementById('feedback-text').classList.remove('active');
                document.querySelector('.feedback-actions').classList.remove('active');
                selectedCategory = '';
                document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('selected'));
                toggleFeedback();
                showCustomAlert('Thank you for your feedback! We appreciate your input.');
            } catch (error) {
                showCustomAlert('Error sending feedback. Please try again.');
            }
        }

        // Close popup when clicking outside
        document.addEventListener('click', function(event) {
            const popup = document.getElementById('popup-box');
            if (popup.classList.contains('active') && !popup.contains(event.target)) {
                const roadmapBoxes = document.querySelectorAll('.roadmap-box');
                let clickedOnBox = false;
                
                roadmapBoxes.forEach(box => {
                    if (box.contains(event.target)) {
                        clickedOnBox = true;
                    }
                });
                
                if (!clickedOnBox) {
                    closePopup();
                }
            }
        });
    </script>
</body>
</html>
